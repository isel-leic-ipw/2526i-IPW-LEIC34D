### First, add a user in Elastic database and put the token here
# Use users-requests-elastic.http
#@token = token-returned
@tokenUser1 = f122742f-8dc4-47dc-81e4-17e0fb810347
@tokenUser2 = 716942d7-ec3d-4500-a55e-087421a769ae

### Insert a task
POST http://localhost:8000/tasks
Content-Type: application/json
Authorization: Bearer {{tokenUser1}}

{
    "title": "Study HTTP",
    "description": "Read the documentation."
}

### Insert another task
POST http://localhost:8000/tasks
Content-Type: application/json
Authorization: Bearer {{tokenUser1}}

{
    "title": "Do class exercise",
    "description": "Implement the tasks web API application."
}

### Insert another task
POST http://localhost:8000/tasks
Content-Type: application/json
Authorization: Bearer {{tokenUser1}}

{
    "title": "Test",
    "description": "A test..."
}

### Insert another task
POST http://localhost:8000/tasks
Content-Type: application/json
Authorization: Bearer {{tokenUser1}}

{
    "title": "Do the assignment 2",
    "description": "Starting with OpenAPI documentation, then implement modules web API, services and data."
}

### Get all tasks
GET http://localhost:8000/tasks
Authorization: Bearer {{tokenUser1}}

### Delete task #get-id-of-a-task
@task-to-delete = 1mad2poB4SbxAyFg2uPZ
DELETE http://localhost:8000/tasks/{{task-to-delete}}
Authorization: Bearer {{tokenUser1}}

### Get task 12ad2poB4SbxAyFg6eMS
GET http://localhost:8000/tasks/12ad2poB4SbxAyFg6eMS
Authorization: Bearer {{tokenUser1}}

### Update task 1Wad2poB4SbxAyFg1ON7
PUT http://localhost:8000/tasks/1Wad2poB4SbxAyFg1ON7
Content-Type: application/json
Authorization: Bearer {{tokenUser1}}

{
    "title": "Do class exercises",
    "description": "Implement the Books web API."
}

### Get task 1Wad2poB4SbxAyFg1ON7
GET http://localhost:8000/tasks/1Wad2poB4SbxAyFg1ON7
Authorization: Bearer {{tokenUser1}}

### Get all tasks (again)
GET http://localhost:8000/tasks
Authorization: Bearer {{tokenUser1}}

### Get tasks with search
GET http://localhost:8000/tasks?search=web+API
Authorization: Bearer {{tokenUser1}}

### Insert a task for user 2
POST http://localhost:8000/tasks
Content-Type: application/json
Authorization: Bearer {{tokenUser2}}

{
    "title": "Test B",
    "description": "A test for user 2..."
}

### Get all tasks for user 2
GET http://localhost:8000/tasks
Authorization: Bearer {{tokenUser2}}

### GET ALL ERRORS
@task-user1 = 12ad2poB4SbxAyFg6eMS
@task-user2 = 2Gaf2poB4SbxAyFg_-OU

### Get tasks with empty token
GET http://localhost:8000/tasks
Authorization: Bearer

### Get tasks with invalid token
GET http://localhost:8000/tasks
Authorization: Bearer 123

### Get tasks with wrong query string
GET http://localhost:8000/tasks?filter=web+API
Authorization: Bearer {{tokenUser1}}

### POST ERRORS

### Insert a task without token
POST http://localhost:8000/tasks
Content-Type: application/json

{
    "title": "Study HTTP",
    "description": "Read the documentation"
}

### Insert a task without token
POST http://localhost:8000/tasks
Content-Type: application/json
Authorization: Bearer 123

{
    "title": "Study HTTP",
    "description": "Read the documentation"
}

### Insert a task with invalid body
POST http://localhost:8000/tasks
Content-Type: application/json
Authorization: Bearer {{tokenUser1}}

{
    "title": "Study HTTP"
}

### Insert a task with bad Json (bad parser)
POST http://localhost:8000/tasks
Content-Type: application/json
Authorization: Bearer {{tokenUser1}}

"title": "Study HTTP",
"description": "Read the documentation."

### GET ID ERRORS

### Get tasks without token
GET http://localhost:8000/tasks/{{task-user1}}

### Get tasks with invalid token
GET http://localhost:8000/tasks/{{task-user1}}
Authorization: Bearer 123

### Get task with inexistent id
GET http://localhost:8000/tasks/100
Authorization: Bearer {{tokenUser1}}

### Get task with invalid user
GET http://localhost:8000/tasks/{{task-user2}}
Authorization: Bearer {{tokenUser1}}

### DELETE ID ERRORS

### Delete task without a token
DELETE http://localhost:8000/tasks/{{task-user1}}

### Delete task with invalid token
DELETE http://localhost:8000/tasks/{{task-user1}}
Authorization: Bearer 123

### Delete task with inexistent id
DELETE http://localhost:8000/tasks/10
Authorization: Bearer {{tokenUser1}}

### Delete task from another user
DELETE http://localhost:8000/tasks/{{task-user2}}
Authorization: Bearer {{tokenUser1}}

### Delete task with missing parameter
DELETE http://localhost:8000/tasks
Authorization: Bearer {{tokenUser1}}

### PUT ID ERRORS

### Replace task without a token
PUT http://localhost:8000/tasks/{{task-user1}}
Content-Type: application/json

{
    "title": "Relax",
    "description": "Go chill..."
}

### Replace task with invalid token
PUT http://localhost:8000/tasks/1{{task-user1}}
Content-Type: application/json
Authorization: Bearer 123

{
    "title": "Relax",
    "description": "Go chill..."
}

### Replace task with inexistent id (but valid)
PUT http://localhost:8000/tasks/{{task-user2}}
Content-Type: application/json
Authorization: Bearer {{tokenUser1}}

{
    "title": "Relax",
    "description": "Go chill..."
}


### Replace task with invalid id
PUT http://localhost:8000/tasks/a
Content-Type: application/json
Authorization: Bearer {{tokenUser1}}

{
    "title": "Relax",
    "description": "Go chill..."
}

### Replace task with invalid body
PUT http://localhost:8000/tasks/{{task-user1}}
Content-Type: application/json
Authorization: Bearer {{tokenUser1}}

{
    "title": "Do the assignment 2"
}

### Replace task with invalid id (empty)
PUT http://localhost:8000/tasks
Content-Type: application/json
Authorization: Bearer {{tokenUser1}}

{
    "title": "Relax",
    "description": "Go chill..."
}



### Final get all tasks to verify if change something
### User 1
GET http://localhost:8000/tasks
Authorization: Bearer {{tokenUser1}}

### User 2
GET http://localhost:8000/tasks
Authorization: Bearer {{tokenUser2}}